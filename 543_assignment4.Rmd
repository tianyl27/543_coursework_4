---
title: "543 Dashboard"
output: html_notebook
---


```{r}
library(flexdashboard)
###
library(ggplot2)
library(plotly)
library(plyr)
library(sf)

```
#### Bar chart  

##### Get the data  

```{r}
myWeb1="https://raw.githubusercontent.com/tianyl27/543_coursework_1/main/"

LifeExp_bar=readRDS(file=url(paste0(myWeb1,"plot1.rds")))

#link = 'https://raw.githubusercontent.com/tianyl27/543_coursework_1/main/WHR2021.csv'
#link1 = 'https://raw.githubusercontent.com/tianyl27/543_coursework_4/main/table1.csv'

# getting the data TABLE from the file:
#WHRData2021 <- read.csv(file=url(link))
#LifeExp <- read.csv(file=url(link))
```

##### Plot  
```{r}
ggplotly(LifeExp_bar)
#ANZ: Australia and New Zealand
# how to get rid of the legend?
```


####  chart  

##### Get the data  


```{r}
myWeb2="https://raw.githubusercontent.com/tianyl27/543_coursework_2/main/"
CovidDeath=readRDS(file=url(paste0(myWeb2,"CovidDeath.rds")))

```

##### Plot  

```{r}
ggplotly(CovidDeath)
```
```{r}
GiniAge=readRDS(file=url(paste0(myWeb2,"GiniAndAge.rds")))
# ggplotly(GiniAge)
```



```{r}
myWeb3="https://raw.githubusercontent.com/tianyl27/543_coursework_3/main/"
CountryMap=readRDS(file=url(paste0(myWeb3,"CountryMap.rds")))
ggplotly(CountryMap)
```

```{r}
linkMap="https://github.com/EvansDataScience/VAforPM_Spatial/raw/main/worldMap.geojson" 

library(sf)
mapWorld=read_sf(linkMap)
base=ggplot(data=mapWorld) + geom_sf(fill='grey90',
                                     color=NA) + theme_classic()

```

```{r}
WHRData2021
Map2021=readRDS(file=url(paste0(myWeb3,"mapWorldVars.rds")))
# leaflet
```

```{r}
TitleText = "Country Performance in COVID epidemic"
CaptionText = "Source: https://worldhappiness.report/ed/2021/"
theLegTitle="World_Performance\n(grey is missing)"

clusterMap= base + geom_sf(data=Map2021,
                       aes(fill=cluster,text=NAME),
                       color=NA)

clusterMap = clusterMap+ scale_fill_brewer(palette ='BuGn',
                              direction = -1,
                              name=theLegTitle)+ labs(title=TitleText,
                                                      caption=CaptionText) +
  theme(plot.title = element_text(hjust = 1), 
        plot.caption = element_text(hjust = 0))
# palette ='BuGn'
# Next: change the color
# How to get rid of the axis

clusterMap%>%ggplotly()
```

